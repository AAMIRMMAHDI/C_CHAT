@ -1,3269 +0,0 @@
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR/VR Messenger - Premium Design</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: radial-gradient(ellipse at top, #0f0f23 0%, #000000 100%);
            color: #ffffff;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 0, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(0, 255, 127, 0.05) 0%, transparent 50%);
            animation: backgroundShift 20s ease-in-out infinite;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes backgroundShift {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Glass morphism effect */
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glass-dark {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Neon glow effects */
        .neon-cyan {
            box-shadow: 
                0 0 5px rgba(0, 255, 255, 0.3),
                0 0 10px rgba(0, 255, 255, 0.2),
                0 0 15px rgba(0, 255, 255, 0.1);
        }

        .neon-magenta {
            box-shadow: 
                0 0 5px rgba(255, 0, 255, 0.3),
                0 0 10px rgba(255, 0, 255, 0.2),
                0 0 15px rgba(255, 0, 255, 0.1);
        }

        /* Main container */
        .messenger-container {
            display: flex;
            height: 100vh;
            position: relative;
        }

        /* Sidebar */
        .sidebar {
            width: 360px;
            background: linear-gradient(180deg, rgba(15, 15, 35, 0.95) 0%, rgba(10, 10, 30, 0.98) 100%);
            backdrop-filter: blur(30px);
            border-right: 1px solid rgba(0, 255, 255, 0.15);
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 10;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                rgba(0, 255, 255, 0.02) 0%, 
                transparent 25%, 
                transparent 75%, 
                rgba(255, 0, 255, 0.02) 100%);
            pointer-events: none;
        }

        /* Profile header */
        .profile-header {
            padding: 24px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
        }

        .profile-card {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .profile-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .profile-card:hover::before {
            left: 100%;
        }

        .profile-card:hover {
            background: rgba(0, 255, 255, 0.05);
            border-color: rgba(0, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .profile-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00ffff 0%, #ff00ff 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 20px;
            position: relative;
            z-index: 2;
        }

        .profile-avatar::after {
            content: '';
            position: absolute;
            inset: -3px;
            border-radius: 50%;
            background: linear-gradient(45deg, #00ffff, #ff00ff, #00ff7f, #00ffff);
            z-index: -1;
            animation: avatarRotate 4s linear infinite;
        }

        @keyframes avatarRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .profile-info h3 {
            font-size: 18px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 4px;
            letter-spacing: -0.02em;
        }

        .profile-info p {
            font-size: 14px;
            color: rgba(0, 255, 255, 0.8);
            font-weight: 400;
        }

        /* Navigation tabs */
        .nav-tabs {
            display: flex;
            margin: 0 24px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 4px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .nav-tab {
            flex: 1;
            padding: 12px 16px;
            text-align: center;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.6);
            border-radius: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .nav-tab.active {
            color: #ffffff;
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.15), rgba(255, 0, 255, 0.15));
            border: 1px solid rgba(0, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 255, 255, 0.1);
        }

        .nav-tab:hover:not(.active) {
            color: rgba(255, 255, 255, 0.9);
            background: rgba(255, 255, 255, 0.05);
        }

        /* Create section */
        .create-section {
            padding: 20px 24px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .create-btn {
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(255, 0, 255, 0.1));
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 12px;
            color: #ffffff;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
        }

        .create-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .create-btn:hover::before {
            left: 100%;
        }

        .create-btn:hover {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.2), rgba(255, 0, 255, 0.2));
            border-color: rgba(0, 255, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.15);
        }

        .create-btn-icon {
            font-size: 18px;
        }

        /* Chat list */
        .chat-list {
            flex: 1;
            overflow-y: auto;
            padding: 8px 0;
        }

        .chat-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 24px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 3px solid transparent;
            position: relative;
        }

        .chat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.05), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .chat-item:hover::before {
            opacity: 1;
        }

        .chat-item:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .chat-item.active {
            background: linear-gradient(90deg, rgba(0, 255, 255, 0.08), rgba(255, 0, 255, 0.05));
            border-left-color: #00ffff;
        }

        .chat-avatar {
            width: 52px;
            height: 52px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 18px;
            flex-shrink: 0;
            position: relative;
        }

        .chat-avatar::after {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff00ff, #00ffff, #00ff7f, #ff00ff);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .chat-item:hover .chat-avatar::after {
            opacity: 1;
            animation: avatarRotate 2s linear infinite;
        }

        .chat-info {
            flex: 1;
            min-width: 0;
        }

        .chat-info h4 {
            font-size: 16px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            letter-spacing: -0.01em;
        }

        .chat-info p {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.4;
        }

        .chat-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 4px;
        }

        .chat-time {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            font-weight: 500;
        }

        .chat-badge {
            background: linear-gradient(135deg, #00ffff, #ff00ff);
            color: #000000;
            font-size: 11px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 10px;
            min-width: 20px;
            text-align: center;
        }

        /* Main content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .main-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 70%, rgba(0, 255, 255, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 70% 30%, rgba(255, 0, 255, 0.03) 0%, transparent 50%);
            pointer-events: none;
        }

        /* Chat header */
        .chat-header {
            padding: 20px 32px;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 5;
        }

        .chat-title-section {
            display: flex;
            align-items: center;
            gap: 16px;
            cursor: pointer;
            padding: 8px;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .chat-title-section:hover {
            background: rgba(0, 255, 255, 0.05);
        }

        .chat-title-section h3 {
            font-size: 20px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 4px;
            letter-spacing: -0.02em;
        }

        .chat-title-section p {
            font-size: 14px;
            color: rgba(0, 255, 255, 0.8);
            font-weight: 500;
        }

        .chat-actions {
            display: flex;
            gap: 12px;
        }

        .action-btn {
            padding: 10px 16px;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 10px;
            color: #ffffff;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-btn:hover {
            background: rgba(0, 255, 255, 0.2);
            border-color: rgba(0, 255, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.2);
        }

        /* Messages container */
        .messages-container {
            flex: 1;
            padding: 24px 32px;
            overflow-y: auto;
            position: relative;
            z-index: 1;
        }

        .message {
            display: flex;
            margin-bottom: 20px;
            animation: messageSlide 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes messageSlide {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }

        .message.sent {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 75%;
            padding: 16px 20px;
            border-radius: 20px;
            position: relative;
            backdrop-filter: blur(10px);
        }

        .message.received .message-content {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(0, 255, 255, 0.05));
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-bottom-left-radius: 6px;
        }

        .message.sent .message-content {
            background: linear-gradient(135deg, rgba(255, 0, 255, 0.1), rgba(255, 0, 255, 0.05));
            border: 1px solid rgba(255, 0, 255, 0.2);
            border-bottom-right-radius: 6px;
        }

        .message-text {
            font-size: 15px;
            line-height: 1.5;
            margin-bottom: 8px;
            color: #ffffff;
            font-weight: 400;
        }

        .message-time {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            text-align: right;
            font-weight: 500;
        }

        /* Input area */
        .input-area {
            padding: 24px 32px;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
            z-index: 5;
        }

        .input-container {
            display: flex;
            gap: 12px;
            align-items: flex-end;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 4px;
            transition: all 0.3s ease;
        }

        .input-container:focus-within {
            border-color: rgba(0, 255, 255, 0.4);
            box-shadow: 0 0 0 4px rgba(0, 255, 255, 0.1);
        }

        .attachment-btn {
            padding: 12px;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 50%;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 18px;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .attachment-btn:hover {
            background: rgba(0, 255, 255, 0.2);
            border-color: rgba(0, 255, 255, 0.4);
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(0, 255, 255, 0.3);
        }

        .message-input {
            flex: 1;
            padding: 14px 20px;
            background: transparent;
            border: none;
            color: #ffffff;
            font-size: 15px;
            outline: none;
            resize: none;
            min-height: 24px;
            max-height: 120px;
            font-family: inherit;
            line-height: 1.5;
        }

        .message-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .send-btn {
            padding: 12px;
            background: linear-gradient(135deg, #00ffff, #ff00ff);
            border: none;
            border-radius: 50%;
            color: #ffffff;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 18px;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .send-btn:hover {
            transform: translateY(-2px) scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.4);
        }

        .send-btn:active {
            transform: translateY(0) scale(1);
        }

        .send-btn.recording {
            background: linear-gradient(135deg, #ff0040, #ff4080);
            animation: recordingPulse 1.5s ease-in-out infinite;
        }

        @keyframes recordingPulse {
            0%, 100% { 
                box-shadow: 0 0 0 0 rgba(255, 0, 64, 0.7);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 0 10px rgba(255, 0, 64, 0);
                transform: scale(1.05);
            }
        }

        /* File attachment menu */
        .attachment-menu {
            position: absolute;
            bottom: 60px;
            left: 32px;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95), rgba(10, 10, 30, 0.98));
            backdrop-filter: blur(30px);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 16px;
            padding: 16px;
            display: none;
            flex-direction: column;
            gap: 12px;
            z-index: 100;
            min-width: 200px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }

        .attachment-menu.active {
            display: flex;
            animation: menuSlideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes menuSlideUp {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.9); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }

        .attachment-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .attachment-option:hover {
            background: rgba(0, 255, 255, 0.1);
            border-color: rgba(0, 255, 255, 0.2);
            transform: translateX(4px);
        }

        .attachment-icon {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        .attachment-text {
            color: #ffffff;
            font-weight: 500;
            font-size: 14px;
        }

        /* Audio recording UI */
        .recording-ui {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            border-radius: 24px;
            z-index: 50;
        }

        .recording-ui.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .recording-content {
            display: flex;
            align-items: center;
            gap: 16px;
            color: #ffffff;
        }

        .recording-indicator {
            width: 12px;
            height: 12px;
            background: #ff0040;
            border-radius: 50%;
            animation: recordingBlink 1s ease-in-out infinite;
        }

        @keyframes recordingBlink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .recording-time {
            font-weight: 600;
            font-variant-numeric: tabular-nums;
            font-size: 16px;
        }

        .recording-waveform {
            display: flex;
            align-items: center;
            gap: 2px;
            height: 24px;
        }

        .waveform-bar {
            width: 3px;
            background: linear-gradient(to top, #00ffff, #ff00ff);
            border-radius: 2px;
            animation: waveformDance 0.8s ease-in-out infinite;
        }

        .waveform-bar:nth-child(1) { animation-delay: 0s; }
        .waveform-bar:nth-child(2) { animation-delay: 0.1s; }
        .waveform-bar:nth-child(3) { animation-delay: 0.2s; }
        .waveform-bar:nth-child(4) { animation-delay: 0.3s; }
        .waveform-bar:nth-child(5) { animation-delay: 0.4s; }

        @keyframes waveformDance {
            0%, 100% { height: 4px; }
            50% { height: 20px; }
        }

        .cancel-recording {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            margin-left: 20px;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .cancel-recording:hover {
            color: #ff0040;
        }

        /* File message styles */
        .file-message {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: rgba(0, 255, 255, 0.05);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 12px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-message:hover {
            background: rgba(0, 255, 255, 0.1);
            border-color: rgba(0, 255, 255, 0.3);
        }

        .file-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #00ffff, #ff00ff);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #ffffff;
            flex-shrink: 0;
        }

        .file-info {
            flex: 1;
            min-width: 0;
        }

        .file-name {
            color: #ffffff;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-size {
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
        }

        /* Audio message styles */
        .audio-message {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: rgba(255, 0, 255, 0.05);
            border: 1px solid rgba(255, 0, 255, 0.2);
            border-radius: 20px;
            margin-bottom: 8px;
            min-width: 200px;
        }

        .audio-play-btn {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #ff00ff, #00ffff);
            border: none;
            border-radius: 50%;
            color: #ffffff;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .audio-play-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(255, 0, 255, 0.4);
        }

        .audio-waveform {
            flex: 1;
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            overflow: hidden;
        }

        .audio-progress {
            height: 100%;
            background: linear-gradient(90deg, #ff00ff, #00ffff);
            border-radius: 12px;
            width: 0%;
            transition: width 0.1s ease;
        }

        .audio-duration {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
            font-variant-numeric: tabular-nums;
            flex-shrink: 0;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95), rgba(10, 10, 30, 0.98));
            backdrop-filter: blur(30px);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 20px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                rgba(0, 255, 255, 0.03) 0%, 
                transparent 25%, 
                transparent 75%, 
                rgba(255, 0, 255, 0.03) 100%);
            border-radius: 20px;
            pointer-events: none;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 28px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 2;
        }

        .modal-title {
            color: #ffffff;
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #ffffff;
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 10px;
            transition: all 0.3s ease;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.4);
        }

        .form-group {
            margin-bottom: 24px;
            position: relative;
            z-index: 2;
        }

        .form-label {
            display: block;
            color: #ffffff;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 14px;
            letter-spacing: -0.01em;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 14px 18px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #ffffff;
            font-size: 15px;
            outline: none;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-input:focus, .form-select:focus {
            border-color: rgba(0, 255, 255, 0.4);
            box-shadow: 0 0 0 4px rgba(0, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.6);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
            line-height: 1.5;
        }

        .btn-primary {
            width: 100%;
            padding: 16px 24px;
            background: linear-gradient(135deg, #00ffff, #ff00ff);
            border: none;
            border-radius: 12px;
            color: #ffffff;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 16px;
            letter-spacing: -0.01em;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0, 255, 255, 0.4);
        }

        .btn-primary:active {
            transform: translateY(-1px);
        }

        /* Video call interface */
        .video-call-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, #0a0a0a 0%, #000000 100%);
            z-index: 2000;
            flex-direction: column;
        }

        .video-call-container.active {
            display: flex;
        }

        .video-header {
            padding: 24px 32px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0, 255, 255, 0.2);
        }

        .video-info h3 {
            color: #ffffff;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 6px;
            letter-spacing: -0.02em;
        }

        .video-info p {
            color: rgba(0, 255, 255, 0.8);
            font-size: 14px;
            font-weight: 500;
        }

        .call-timer {
            color: #00ffff;
            font-size: 18px;
            font-weight: 600;
            font-variant-numeric: tabular-nums;
        }

        .video-main {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: 
                radial-gradient(circle at 30% 70%, rgba(0, 255, 255, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 70% 30%, rgba(255, 0, 255, 0.05) 0%, transparent 50%);
        }

        .video-placeholder {
            width: 85%;
            max-width: 900px;
            height: 70%;
            background: rgba(0, 255, 255, 0.03);
            border: 2px solid rgba(0, 255, 255, 0.2);
            border-radius: 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .video-placeholder::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                rgba(0, 255, 255, 0.02) 0%, 
                transparent 25%, 
                transparent 75%, 
                rgba(255, 0, 255, 0.02) 100%);
            animation: videoShimmer 3s ease-in-out infinite;
        }

        @keyframes videoShimmer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .video-placeholder-icon {
            font-size: 80px;
            margin-bottom: 24px;
            position: relative;
            z-index: 2;
        }

        .video-placeholder h4 {
            color: #ffffff;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 12px;
            letter-spacing: -0.02em;
            position: relative;
            z-index: 2;
        }

        .video-placeholder p {
            color: rgba(255, 255, 255, 0.6);
            font-size: 16px;
            font-weight: 500;
            position: relative;
            z-index: 2;
        }

        .video-controls {
            padding: 32px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: center;
            gap: 20px;
            border-top: 1px solid rgba(0, 255, 255, 0.2);
        }

        .video-btn {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            border: 2px solid rgba(0, 255, 255, 0.3);
            background: rgba(0, 255, 255, 0.1);
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            position: relative;
            overflow: hidden;
        }

        .video-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle, rgba(0, 255, 255, 0.2) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .video-btn:hover::before {
            opacity: 1;
        }

        .video-btn:hover {
            background: rgba(0, 255, 255, 0.2);
            border-color: rgba(0, 255, 255, 0.5);
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.3);
        }

        .video-btn.end-call {
            background: rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.5);
        }

        .video-btn.end-call:hover {
            background: rgba(255, 0, 0, 0.3);
            border-color: rgba(255, 0, 0, 0.7);
            box-shadow: 0 8px 25px rgba(255, 0, 0, 0.3);
        }

        /* Context menu styles */
        .context-menu {
            position: fixed;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95), rgba(10, 10, 30, 0.98));
            backdrop-filter: blur(30px);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 12px;
            padding: 8px 0;
            display: none;
            z-index: 10000;
            min-width: 180px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            animation: contextMenuSlide 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .context-menu.active {
            display: block;
        }

        @keyframes contextMenuSlide {
            from { 
                opacity: 0; 
                transform: translateY(-10px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }

        .context-menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #ffffff;
            font-size: 14px;
            font-weight: 500;
        }

        .context-menu-item:hover {
            background: rgba(0, 255, 255, 0.1);
        }

        .context-menu-item.danger:hover {
            background: rgba(255, 0, 0, 0.1);
            color: #ff4444;
        }

        .context-menu-icon {
            font-size: 16px;
            width: 20px;
            text-align: center;
        }

        .context-menu-separator {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 4px 0;
        }

        /* Message selection styles */
        .message.selected {
            background: rgba(0, 255, 255, 0.1);
            border-radius: 12px;
            margin: -4px;
            padding: 4px;
        }

        .message-content.selectable {
            position: relative;
            cursor: pointer;
        }

        .message-content.selectable::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border: 2px solid transparent;
            border-radius: 22px;
            transition: border-color 0.2s ease;
            pointer-events: none;
        }

        .message-content.selectable:hover::before {
            border-color: rgba(0, 255, 255, 0.3);
        }

        /* Selection toolbar */
        .selection-toolbar {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95), rgba(10, 10, 30, 0.98));
            backdrop-filter: blur(30px);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 16px;
            padding: 12px 20px;
            display: none;
            align-items: center;
            gap: 16px;
            z-index: 9999;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }

        .selection-toolbar.active {
            display: flex;
            animation: toolbarSlideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes toolbarSlideDown {
            from { 
                opacity: 0; 
                transform: translateX(-50%) translateY(-20px); 
            }
            to { 
                opacity: 1; 
                transform: translateX(-50%) translateY(0); 
            }
        }

        .selection-count {
            color: #ffffff;
            font-weight: 600;
            font-size: 14px;
        }

        .toolbar-btn {
            padding: 8px 12px;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 8px;
            color: #ffffff;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .toolbar-btn:hover {
            background: rgba(0, 255, 255, 0.2);
            border-color: rgba(0, 255, 255, 0.4);
        }

        .toolbar-btn.danger {
            background: rgba(255, 0, 0, 0.1);
            border-color: rgba(255, 0, 0, 0.2);
        }

        .toolbar-btn.danger:hover {
            background: rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.4);
        }

        /* Long press indicator */
        .long-press-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            border: 3px solid rgba(0, 255, 255, 0.3);
            border-radius: 50%;
            display: none;
            pointer-events: none;
        }

        .long-press-indicator.active {
            display: block;
            animation: longPressRipple 0.8s ease-out;
        }

        @keyframes longPressRipple {
            0% {
                width: 0;
                height: 0;
                opacity: 1;
            }
            100% {
                width: 60px;
                height: 60px;
                opacity: 0;
            }
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.5), rgba(255, 0, 255, 0.5));
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.7), rgba(255, 0, 255, 0.7));
        }

        /* Profile detail styles */
        .profile-info-section {
            margin-bottom: 24px;
        }

        .profile-detail-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .profile-detail-item:last-child {
            border-bottom: none;
        }

        .detail-icon {
            font-size: 16px;
            width: 24px;
            text-align: center;
        }

        .detail-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            font-weight: 500;
            min-width: 120px;
        }

        .detail-value {
            color: #ffffff;
            font-size: 14px;
            font-weight: 600;
            flex: 1;
        }

        .profile-action-btn {
            flex: 1;
            padding: 12px 16px;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 12px;
            color: #ffffff;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .profile-action-btn:hover {
            background: rgba(0, 255, 255, 0.2);
            border-color: rgba(0, 255, 255, 0.4);
            transform: translateY(-2px);
        }

        .profile-action-btn.primary {
            background: linear-gradient(135deg, #00ffff, #ff00ff);
            border-color: transparent;
        }

        .profile-action-btn.primary:hover {
            background: linear-gradient(135deg, #00cccc, #cc00cc);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.3);
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: absolute;
                z-index: 100;
                transform: translateX(-100%);
                transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                width: 100%;
            }

            .chat-header {
                padding: 16px 20px;
            }

            .messages-container {
                padding: 16px 20px;
            }

            .input-area {
                padding: 16px 20px;
            }

            .message-content {
                max-width: 85%;
            }
        }
    </style>
</head>
<body>
    <div class="messenger-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <!-- Profile Header -->
            <div class="profile-header">
                <div class="profile-card" onclick="openProfileModal()">
                    <div class="profile-avatar">JD</div>
                    <div class="profile-info">
                        <h3>John Doe</h3>
                        <p>AR/VR Mode Active</p>
                    </div>
                </div>
            </div>

            <!-- Navigation Tabs -->
            <div class="nav-tabs">
                <div class="nav-tab active" onclick="switchTab('chats')">Chats</div>
                <div class="nav-tab" onclick="switchTab('groups')">Groups</div>
                <div class="nav-tab" onclick="switchTab('channels')">Channels</div>
            </div>

            <!-- Create Section -->
            <div class="create-section" id="createSection" style="display: none;">
                <button class="create-btn" onclick="openGroupModal()">
                    <span class="create-btn-icon">👥</span>
                    <span>New Group</span>
                </button>
                <button class="create-btn" onclick="openChannelModal()">
                    <span class="create-btn-icon">📢</span>
                    <span>New Channel</span>
                </button>
            </div>

            <!-- Chat List -->
            <div class="chat-list">
                <!-- Chats Tab -->
                <div class="tab-content" id="chatsTab">
                    <div class="chat-item active" onclick="selectChat('Alex Chen', 'A')">
                        <div class="chat-avatar">A</div>
                        <div class="chat-info">
                            <h4>Alex Chen</h4>
                            <p>Ready for the AR meeting? I've set up the virtual space.</p>
                        </div>
                        <div class="chat-meta">
                            <div class="chat-time">10:30</div>
                            <div class="chat-badge">2</div>
                        </div>
                    </div>
                    <div class="chat-item" onclick="selectChat('Sarah Wilson', 'S')">
                        <div class="chat-avatar">S</div>
                        <div class="chat-info">
                            <h4>Sarah Wilson</h4>
                            <p>The VR demo was absolutely amazing! Can't wait for the next session.</p>
                        </div>
                        <div class="chat-meta">
                            <div class="chat-time">09:45</div>
                        </div>
                    </div>
                    <div class="chat-item" onclick="selectChat('Mike Johnson', 'M')">
                        <div class="chat-avatar">M</div>
                        <div class="chat-info">
                            <h4>Mike Johnson</h4>
                            <p>Let's sync tomorrow about the holographic interface updates</p>
                        </div>
                        <div class="chat-meta">
                            <div class="chat-time">Yesterday</div>
                        </div>
                    </div>
                </div>

                <!-- Groups Tab -->
                <div class="tab-content" id="groupsTab" style="display: none;">
                    <div class="chat-item" onclick="selectChat('AR/VR Team', 'T')">
                        <div class="chat-avatar">T</div>
                        <div class="chat-info">
                            <h4>AR/VR Team</h4>
                            <p>Mike: Let's sync tomorrow about the new features</p>
                        </div>
                        <div class="chat-meta">
                            <div class="chat-time">11:20</div>
                            <div class="chat-badge">5</div>
                        </div>
                    </div>
                    <div class="chat-item" onclick="selectChat('Design Squad', 'D')">
                        <div class="chat-avatar">D</div>
                        <div class="chat-info">
                            <h4>Design Squad</h4>
                            <p>New holographic mockups are ready for review</p>
                        </div>
                        <div class="chat-meta">
                            <div class="chat-time">08:15</div>
                        </div>
                    </div>
                </div>

                <!-- Channels Tab -->
                <div class="tab-content" id="channelsTab" style="display: none;">
                    <div class="chat-item" onclick="selectChat('Dev Updates', '#')">
                        <div class="chat-avatar">#</div>
                        <div class="chat-info">
                            <h4>Dev Updates</h4>
                            <p>🚀 New hologram rendering features have been released!</p>
                        </div>
                        <div class="chat-meta">
                            <div class="chat-time">12:00</div>
                        </div>
                    </div>
                    <div class="chat-item" onclick="selectChat('AR News', '#')">
                        <div class="chat-avatar">#</div>
                        <div class="chat-info">
                            <h4>AR News</h4>
                            <p>Latest AR technology trends and breakthrough innovations</p>
                        </div>
                        <div class="chat-meta">
                            <div class="chat-time">10:30</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="chat-title-section" onclick="openChatProfile()">
                    <div class="profile-avatar" id="currentChatAvatar">A</div>
                    <div>
                        <h3 id="currentChatName">Alex Chen</h3>
                        <p id="currentChatStatus">Active in AR Space</p>
                    </div>
                </div>
                <div class="chat-actions">
                    <button class="action-btn" onclick="startVideoCall()">
                        <span>📹</span> Video
                    </button>
                    <button class="action-btn" onclick="startAudioCall()">
                        <span>📞</span> Call
                    </button>
                    <button class="action-btn" onclick="openChatOptions()">
                        <span>⋮</span>
                    </button>
                </div>
            </div>

            <!-- Messages -->
            <div class="messages-container" id="messagesContainer">
                <div class="message received" data-message-id="1">
                    <div class="message-content selectable">
                        <div class="message-text">Hey! Ready for the AR meeting? I've set up the virtual space and everything looks incredible.</div>
                        <div class="message-time">10:30 AM</div>
                    </div>
                </div>
                <div class="message sent" data-message-id="2">
                    <div class="message-content selectable">
                        <div class="message-text">Absolutely! The holographic interface looks amazing. Can't wait to test all the new features we've been working on.</div>
                        <div class="message-time">10:32 AM</div>
                    </div>
                </div>
                <div class="message received" data-message-id="3">
                    <div class="message-content selectable">
                        <div class="message-text">Perfect! I'll share the VR environment link. The spatial audio is working beautifully now, and the visual effects are stunning.</div>
                        <div class="message-time">10:35 AM</div>
                    </div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="input-area">
                <!-- Attachment Menu -->
                <div class="attachment-menu" id="attachmentMenu">
                    <div class="attachment-option" onclick="selectFile('image')">
                        <div class="attachment-icon">🖼️</div>
                        <div class="attachment-text">Photo</div>
                    </div>
                    <div class="attachment-option" onclick="selectFile('video')">
                        <div class="attachment-icon">🎥</div>
                        <div class="attachment-text">Video</div>
                    </div>
                    <div class="attachment-option" onclick="selectFile('document')">
                        <div class="attachment-icon">📄</div>
                        <div class="attachment-text">Document</div>
                    </div>
                    <div class="attachment-option" onclick="selectFile('music')">
                        <div class="attachment-icon">🎵</div>
                        <div class="attachment-text">Music</div>
                    </div>
                    <div class="attachment-option" onclick="selectFile('any')">
                        <div class="attachment-icon">📎</div>
                        <div class="attachment-text">File</div>
                    </div>
                </div>

                <div class="input-container">
                    <!-- Recording UI Overlay -->
                    <div class="recording-ui" id="recordingUI">
                        <div class="recording-content">
                            <div class="recording-indicator"></div>
                            <div class="recording-time" id="recordingTime">0:00</div>
                            <div class="recording-waveform">
                                <div class="waveform-bar"></div>
                                <div class="waveform-bar"></div>
                                <div class="waveform-bar"></div>
                                <div class="waveform-bar"></div>
                                <div class="waveform-bar"></div>
                            </div>
                            <div class="cancel-recording" onclick="cancelRecording()">Cancel</div>
                        </div>
                    </div>

                    <button class="attachment-btn" onclick="toggleAttachmentMenu()" id="attachmentBtn">📎</button>
                    <textarea class="message-input" placeholder="Type your message..." id="messageInput" rows="1"></textarea>
                    <button class="send-btn" onclick="handleSendAction()" id="sendBtn">
                        <span id="sendIcon">➤</span>
                    </button>
                </div>

                <!-- Hidden file inputs -->
                <input type="file" id="imageInput" accept="image/*" style="display: none;" onchange="handleFileSelect(event, 'image')">
                <input type="file" id="videoInput" accept="video/*" style="display: none;" onchange="handleFileSelect(event, 'video')">
                <input type="file" id="documentInput" accept=".pdf,.doc,.docx,.txt,.rtf" style="display: none;" onchange="handleFileSelect(event, 'document')">
                <input type="file" id="musicInput" accept="audio/*" style="display: none;" onchange="handleFileSelect(event, 'music')">
                <input type="file" id="anyInput" style="display: none;" onchange="handleFileSelect(event, 'any')">
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-item" onclick="replyToMessage()">
            <div class="context-menu-icon">↩️</div>
            <div>Reply</div>
        </div>
        <div class="context-menu-item" onclick="editMessage()">
            <div class="context-menu-icon">✏️</div>
            <div>Edit</div>
        </div>
        <div class="context-menu-item" onclick="copyMessage()">
            <div class="context-menu-icon">📋</div>
            <div>Copy</div>
        </div>
        <div class="context-menu-item" onclick="forwardMessage()">
            <div class="context-menu-icon">➡️</div>
            <div>Forward</div>
        </div>
        <div class="context-menu-item" onclick="selectMessage()">
            <div class="context-menu-icon">☑️</div>
            <div>Select</div>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" onclick="pinMessage()">
            <div class="context-menu-icon">📌</div>
            <div>Pin</div>
        </div>
        <div class="context-menu-item" onclick="saveToFavorites()">
            <div class="context-menu-icon">⭐</div>
            <div>Save to Favorites</div>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item danger" onclick="deleteMessage()">
            <div class="context-menu-icon">🗑️</div>
            <div>Delete</div>
        </div>
    </div>

    <!-- Selection Toolbar -->
    <div class="selection-toolbar" id="selectionToolbar">
        <div class="selection-count" id="selectionCount">1 selected</div>
        <button class="toolbar-btn" onclick="replyToSelected()">
            <span>↩️</span> Reply
        </button>
        <button class="toolbar-btn" onclick="forwardSelected()">
            <span>➡️</span> Forward
        </button>
        <button class="toolbar-btn" onclick="copySelected()">
            <span>📋</span> Copy
        </button>
        <button class="toolbar-btn danger" onclick="deleteSelected()">
            <span>🗑️</span> Delete
        </button>
        <button class="toolbar-btn" onclick="clearSelection()">
            <span>✖️</span> Cancel
        </button>
    </div>

    <!-- Long Press Indicator -->
    <div class="long-press-indicator" id="longPressIndicator"></div>

    <!-- Profile Modal -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Profile Settings</h2>
                <button class="close-btn" onclick="closeModal('profileModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Display Name</label>
                <input type="text" class="form-input" value="John Doe" id="displayName">
            </div>
            <div class="form-group">
                <label class="form-label">Status Message</label>
                <input type="text" class="form-input" value="AR/VR Mode Active" id="statusMessage">
            </div>
            <div class="form-group">
                <label class="form-label">Avatar Theme</label>
                <select class="form-select" id="avatarTheme">
                    <option>Holographic Cyan</option>
                    <option>Neon Magenta</option>
                    <option>Cyber Green</option>
                    <option>Plasma Orange</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">VR Environment</label>
                <select class="form-select" id="vrEnvironment">
                    <option>Cyber City</option>
                    <option>Space Station</option>
                    <option>Digital Forest</option>
                    <option>Neon Grid</option>
                </select>
            </div>
            <button class="btn-primary" onclick="saveProfile()">Save Changes</button>
        </div>
    </div>

    <!-- Group Modal -->
    <div class="modal" id="groupModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create New Group</h2>
                <button class="close-btn" onclick="closeModal('groupModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Group Name</label>
                <input type="text" class="form-input" placeholder="Enter group name" id="groupName">
            </div>
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea class="form-input form-textarea" placeholder="Describe your AR/VR group" id="groupDescription"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Virtual Space Theme</label>
                <select class="form-select" id="groupSpace">
                    <option>Holographic Conference</option>
                    <option>Cyber Lounge</option>
                    <option>Space Meeting Room</option>
                    <option>Digital Workshop</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Privacy Level</label>
                <select class="form-select" id="groupPrivacy">
                    <option>Public AR Space</option>
                    <option>Private VR Room</option>
                    <option>Invite Only</option>
                </select>
            </div>
            <button class="btn-primary" onclick="createGroup()">Create Group</button>
        </div>
    </div>

    <!-- Channel Modal -->
    <div class="modal" id="channelModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create New Channel</h2>
                <button class="close-btn" onclick="closeModal('channelModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Channel Name</label>
                <input type="text" class="form-input" placeholder="Enter channel name" id="channelName">
            </div>
            <div class="form-group">
                <label class="form-label">Channel Type</label>
                <select class="form-select" id="channelType">
                    <option>AR Broadcast</option>
                    <option>VR Experience</option>
                    <option>Mixed Reality</option>
                    <option>Hologram Stream</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea class="form-input form-textarea" placeholder="Describe your AR/VR channel" id="channelDescription"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Immersion Level</label>
                <select class="form-select" id="immersionLevel">
                    <option>Full VR Immersion</option>
                    <option>AR Overlay</option>
                    <option>Mixed Reality</option>
                    <option>Holographic Display</option>
                </select>
            </div>
            <button class="btn-primary" onclick="createChannel()">Create Channel</button>
        </div>
    </div>

    <!-- Chat Profile Modal -->
    <div class="modal" id="chatProfileModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="modal-title" id="chatProfileTitle">Alex Chen</h2>
                <button class="close-btn" onclick="closeModal('chatProfileModal')">&times;</button>
            </div>
            
            <!-- Profile Header Section -->
            <div style="text-align: center; margin-bottom: 32px; position: relative; z-index: 2;">
                <div class="profile-avatar" id="chatProfileAvatar" style="width: 120px; height: 120px; font-size: 48px; margin: 0 auto 16px;">A</div>
                <h3 id="chatProfileName" style="color: #ffffff; font-size: 24px; font-weight: 700; margin-bottom: 8px;">Alex Chen</h3>
                <p id="chatProfileStatus" style="color: rgba(0, 255, 255, 0.8); font-size: 16px; margin-bottom: 16px;">Active in AR Space</p>
                <p id="chatProfilePhone" style="color: rgba(255, 255, 255, 0.6); font-size: 14px; margin-bottom: 4px;">+1 (555) 123-4567</p>
                <p id="chatProfileUsername" style="color: rgba(255, 255, 255, 0.6); font-size: 14px;">@alexchen_ar</p>
            </div>

            <!-- Profile Info Section -->
            <div style="position: relative; z-index: 2;">
                <div class="profile-info-section">
                    <h4 style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 16px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 8px;">About</h4>
                    <p id="chatProfileBio" style="color: rgba(255, 255, 255, 0.8); line-height: 1.6; margin-bottom: 20px;">AR/VR Developer passionate about creating immersive experiences. Currently working on next-gen holographic interfaces and spatial computing solutions.</p>
                </div>

                <div class="profile-info-section">
                    <h4 style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 16px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 8px;">Details</h4>
                    <div class="profile-detail-item">
                        <span class="detail-icon">🌐</span>
                        <span class="detail-label">VR Environment:</span>
                        <span class="detail-value" id="chatProfileVREnv">Cyber City</span>
                    </div>
                    <div class="profile-detail-item">
                        <span class="detail-icon">⏰</span>
                        <span class="detail-label">Time Zone:</span>
                        <span class="detail-value" id="chatProfileTimezone">PST (UTC-8)</span>
                    </div>
                    <div class="profile-detail-item">
                        <span class="detail-icon">📅</span>
                        <span class="detail-label">Joined:</span>
                        <span class="detail-value" id="chatProfileJoined">March 2024</span>
                    </div>
                    <div class="profile-detail-item">
                        <span class="detail-icon">🎯</span>
                        <span class="detail-label">AR Score:</span>
                        <span class="detail-value" id="chatProfileScore">2,847 points</span>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div style="display: flex; gap: 12px; margin-top: 24px;">
                    <button class="profile-action-btn primary" onclick="startChatFromProfile()">
                        <span>💬</span> Message
                    </button>
                    <button class="profile-action-btn" onclick="startVideoCall()">
                        <span>📹</span> Video Call
                    </button>
                    <button class="profile-action-btn" onclick="startAudioCall()">
                        <span>📞</span> Audio Call
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Options Menu -->
    <div class="context-menu" id="chatOptionsMenu" style="min-width: 200px;">
        <div class="context-menu-item" onclick="viewSharedMedia()">
            <div class="context-menu-icon">🖼️</div>
            <div>Shared Media</div>
        </div>
        <div class="context-menu-item" onclick="searchInChat()">
            <div class="context-menu-icon">🔍</div>
            <div>Search</div>
        </div>
        <div class="context-menu-item" onclick="exportChat()">
            <div class="context-menu-icon">📤</div>
            <div>Export Chat</div>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" onclick="muteNotifications()">
            <div class="context-menu-icon">🔕</div>
            <div>Mute Notifications</div>
        </div>
        <div class="context-menu-item" onclick="changeWallpaper()">
            <div class="context-menu-icon">🎨</div>
            <div>Change Wallpaper</div>
        </div>
        <div class="context-menu-item" onclick="clearChatHistory()">
            <div class="context-menu-icon">🧹</div>
            <div>Clear History</div>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" onclick="blockUser()">
            <div class="context-menu-icon">🚫</div>
            <div>Block User</div>
        </div>
        <div class="context-menu-item danger" onclick="deleteChat()">
            <div class="context-menu-icon">🗑️</div>
            <div>Delete Chat</div>
        </div>
    </div>

    <!-- Video Call Interface -->
    <div class="video-call-container" id="videoCallContainer">
        <div class="video-header">
            <div class="video-info">
                <h3>Video Call - Alex Chen</h3>
                <p>Connected to AR/VR Space</p>
            </div>
            <div class="call-timer" id="callTimer">00:00</div>
        </div>
        
        <div class="video-main">
            <div class="video-placeholder">
                <div class="video-placeholder-icon">🎭</div>
                <h4>AR/VR Video Call</h4>
                <p>Holographic rendering active</p>
            </div>
        </div>

        <div class="video-controls">
            <button class="video-btn" onclick="toggleMute()" id="muteBtn">🎤</button>
            <button class="video-btn" onclick="toggleVideo()" id="videoBtn">📹</button>
            <button class="video-btn" onclick="toggleAR()" id="arBtn">🥽</button>
            <button class="video-btn" onclick="shareScreen()">📺</button>
            <button class="video-btn end-call" onclick="endCall()">📞</button>
        </div>
    </div>

    <script>
        let currentTab = 'chats';
        let currentChat = 'Alex Chen';
        let callTimer = 0;
        let callInterval;
        let isMuted = false;
        let isVideoOn = true;
        let isARMode = false;
        let isRecording = false;
        let recordingTimer = 0;
        let recordingInterval;
        let mediaRecorder;
        let audioChunks = [];
        let attachmentMenuOpen = false;
        let selectedMessages = new Set();
        let currentContextMessage = null;
        let longPressTimer = null;
        let longPressStarted = false;
        let messageIdCounter = 4; // Start from 4 since we have 3 initial messages

        // Tab switching with smooth animations
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Hide all tab contents with fade effect
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.opacity = '0';
                setTimeout(() => content.style.display = 'none', 150);
            });
            
            // Show selected tab with fade in
            setTimeout(() => {
                document.getElementById(tabName + 'Tab').style.display = 'block';
                setTimeout(() => {
                    document.getElementById(tabName + 'Tab').style.opacity = '1';
                }, 50);
            }, 150);
            
            currentTab = tabName;

            // Update create section visibility
            const createSection = document.getElementById('createSection');
            if (tabName === 'chats') {
                createSection.style.display = 'none';
            } else {
                createSection.style.display = 'block';
            }
        }

        // Enhanced chat selection
        function selectChat(name, avatar) {
            currentChat = name;
            
            // Update header with animation
            const chatName = document.getElementById('currentChatName');
            const chatAvatar = document.getElementById('currentChatAvatar');
            const chatStatus = document.getElementById('currentChatStatus');
            
            chatName.style.opacity = '0';
            chatAvatar.style.opacity = '0';
            chatStatus.style.opacity = '0';
            
            setTimeout(() => {
                chatName.textContent = name;
                chatAvatar.textContent = avatar;
                
                const statusMap = {
                    'Alex Chen': 'Active in AR Space',
                    'Sarah Wilson': 'Last seen 5 minutes ago',
                    'Mike Johnson': 'Online',
                    'AR/VR Team': '5 members, 3 online',
                    'Design Squad': '8 members, 2 online',
                    'Dev Updates': 'Channel • 156 subscribers',
                    'AR News': 'Channel • 2.3K subscribers'
                };
                
                chatStatus.textContent = statusMap[name] || 'Online';
                
                chatName.style.opacity = '1';
                chatAvatar.style.opacity = '1';
                chatStatus.style.opacity = '1';
            }, 150);
            
            // Update active chat item
            document.querySelectorAll('.chat-item').forEach(item => item.classList.remove('active'));
            event.target.closest('.chat-item').classList.add('active');
        }

        // Update send button icon based on input
        function updateSendButton() {
            const input = document.getElementById('messageInput');
            const sendIcon = document.getElementById('sendIcon');
            const sendBtn = document.getElementById('sendBtn');
            
            if (input.value.trim()) {
                sendIcon.innerHTML = '➤';
                sendBtn.title = 'Send message';
            } else {
                sendIcon.innerHTML = `
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <rect x="2" y="8" width="2" height="8" rx="1">
                            <animate attributeName="height" values="8;16;8" dur="1.5s" repeatCount="indefinite" begin="0s"/>
                            <animate attributeName="y" values="8;4;8" dur="1.5s" repeatCount="indefinite" begin="0s"/>
                        </rect>
                        <rect x="6" y="6" width="2" height="12" rx="1">
                            <animate attributeName="height" values="12;20;12" dur="1.5s" repeatCount="indefinite" begin="0.2s"/>
                            <animate attributeName="y" values="6;2;6" dur="1.5s" repeatCount="indefinite" begin="0.2s"/>
                        </rect>
                        <rect x="10" y="4" width="2" height="16" rx="1">
                            <animate attributeName="height" values="16;24;16" dur="1.5s" repeatCount="indefinite" begin="0.4s"/>
                            <animate attributeName="y" values="4;0;4" dur="1.5s" repeatCount="indefinite" begin="0.4s"/>
                        </rect>
                        <rect x="14" y="6" width="2" height="12" rx="1">
                            <animate attributeName="height" values="12;18;12" dur="1.5s" repeatCount="indefinite" begin="0.6s"/>
                            <animate attributeName="y" values="6;3;6" dur="1.5s" repeatCount="indefinite" begin="0.6s"/>
                        </rect>
                        <rect x="18" y="8" width="2" height="8" rx="1">
                            <animate attributeName="height" values="8;14;8" dur="1.5s" repeatCount="indefinite" begin="0.8s"/>
                            <animate attributeName="y" values="8;5;8" dur="1.5s" repeatCount="indefinite" begin="0.8s"/>
                        </rect>
                    </svg>
                `;
                sendBtn.title = 'Hold to record audio';
            }
        }

        // Handle send button action (send message or start recording)
        function handleSendAction() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message) {
                sendMessage();
            } else {
                startRecording();
            }
        }

        // Enhanced message sending
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message) {
                const messagesContainer = document.getElementById('messagesContainer');
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message sent';
                messageDiv.setAttribute('data-message-id', messageIdCounter++);
                messageDiv.innerHTML = `
                    <div class="message-content selectable">
                        <div class="message-text">${message}</div>
                        <div class="message-time">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
                    </div>
                `;
                
                // Add context menu event listeners
                addMessageEventListeners(messageDiv);
                
                messagesContainer.appendChild(messageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                input.value = '';
                input.style.height = 'auto';
                updateSendButton();
                
                // Enhanced auto-response
                setTimeout(() => {
                    const responses = [
                        "That sounds fantastic! The AR interface is incredibly responsive today.",
                        "Amazing! I love how the holographic elements are rendering so smoothly.",
                        "Perfect! The spatial audio quality has really improved with the latest updates.",
                        "Excellent work! The VR environment feels more immersive than ever.",
                        "Great idea! Let's implement that in our next AR session."
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    
                    const responseDiv = document.createElement('div');
                    responseDiv.className = 'message received';
                    responseDiv.setAttribute('data-message-id', messageIdCounter++);
                    responseDiv.innerHTML = `
                        <div class="message-content selectable">
                            <div class="message-text">${randomResponse}</div>
                            <div class="message-time">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
                        </div>
                    `;
                    
                    // Add context menu event listeners
                    addMessageEventListeners(responseDiv);
                    
                    messagesContainer.appendChild(responseDiv);
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                }, 1200);
            }
        }

        // Audio recording functions
        async function startRecording() {
            if (isRecording) return;
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                audioChunks = [];
                
                mediaRecorder.ondataavailable = (event) => {
                    audioChunks.push(event.data);
                };
                
                mediaRecorder.onstop = () => {
                    const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                    sendAudioMessage(audioBlob);
                    stream.getTracks().forEach(track => track.stop());
                };
                
                mediaRecorder.start();
                isRecording = true;
                recordingTimer = 0;
                
                // Show recording UI
                document.getElementById('recordingUI').classList.add('active');
                document.getElementById('sendBtn').classList.add('recording');
                
                // Start timer
                recordingInterval = setInterval(() => {
                    recordingTimer++;
                    const minutes = Math.floor(recordingTimer / 60);
                    const seconds = recordingTimer % 60;
                    document.getElementById('recordingTime').textContent = 
                        `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
                
            } catch (error) {
                showNotification('❌ Microphone access denied. Please allow microphone access to record audio.');
            }
        }

        function stopRecording() {
            if (!isRecording) return;
            
            isRecording = false;
            clearInterval(recordingInterval);
            
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
            }
            
            // Hide recording UI
            document.getElementById('recordingUI').classList.remove('active');
            document.getElementById('sendBtn').classList.remove('recording');
        }

        function cancelRecording() {
            if (!isRecording) return;
            
            isRecording = false;
            clearInterval(recordingInterval);
            
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
            }
            
            // Hide recording UI
            document.getElementById('recordingUI').classList.remove('active');
            document.getElementById('sendBtn').classList.remove('recording');
            
            // Clear audio chunks
            audioChunks = [];
            
            showNotification('🎤 Recording cancelled');
        }

        function sendAudioMessage(audioBlob) {
            const messagesContainer = document.getElementById('messagesContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message sent';
            messageDiv.setAttribute('data-message-id', messageIdCounter++);
            
            const duration = Math.max(1, recordingTimer);
            const minutes = Math.floor(duration / 60);
            const seconds = duration % 60;
            const durationText = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            messageDiv.innerHTML = `
                <div class="message-content selectable">
                    <div class="audio-message">
                        <button class="audio-play-btn" onclick="playAudio(this)">▶️</button>
                        <div class="audio-waveform" onclick="seekAudio(this, event)">
                            <div class="audio-progress"></div>
                        </div>
                        <div class="audio-duration">${durationText}</div>
                    </div>
                    <div class="message-time">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
                </div>
            `;
            
            // Store audio blob for playback
            const audioElement = messageDiv.querySelector('.audio-message');
            audioElement.audioBlob = audioBlob;
            audioElement.duration = duration;
            
            // Add context menu event listeners
            addMessageEventListeners(messageDiv);
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            showNotification('🎤 Audio message sent!');
        }

        // File attachment functions
        function toggleAttachmentMenu() {
            const menu = document.getElementById('attachmentMenu');
            attachmentMenuOpen = !attachmentMenuOpen;
            
            if (attachmentMenuOpen) {
                menu.classList.add('active');
            } else {
                menu.classList.remove('active');
            }
        }

        function selectFile(type) {
            const inputMap = {
                'image': 'imageInput',
                'video': 'videoInput',
                'document': 'documentInput',
                'music': 'musicInput',
                'any': 'anyInput'
            };
            
            const input = document.getElementById(inputMap[type]);
            input.click();
            
            // Close attachment menu
            toggleAttachmentMenu();
        }

        function handleFileSelect(event, type) {
            const file = event.target.files[0];
            if (!file) return;
            
            sendFileMessage(file, type);
            
            // Clear the input
            event.target.value = '';
        }

        function sendFileMessage(file, type) {
            const messagesContainer = document.getElementById('messagesContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message sent';
            messageDiv.setAttribute('data-message-id', messageIdCounter++);
            
            const fileSize = formatFileSize(file.size);
            const fileIcon = getFileIcon(file.name, type);
            
            messageDiv.innerHTML = `
                <div class="message-content selectable">
                    <div class="file-message" onclick="downloadFile('${file.name}')">
                        <div class="file-icon">${fileIcon}</div>
                        <div class="file-info">
                            <div class="file-name">${file.name}</div>
                            <div class="file-size">${fileSize}</div>
                        </div>
                    </div>
                    <div class="message-time">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
                </div>
            `;
            
            // Add context menu event listeners
            addMessageEventListeners(messageDiv);
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            showNotification(`📎 ${file.name} sent!`);
        }

        function getFileIcon(fileName, type) {
            const extension = fileName.split('.').pop().toLowerCase();
            
            const iconMap = {
                // Images
                'jpg': '🖼️', 'jpeg': '🖼️', 'png': '🖼️', 'gif': '🖼️', 'webp': '🖼️',
                // Videos
                'mp4': '🎥', 'avi': '🎥', 'mov': '🎥', 'wmv': '🎥', 'webm': '🎥',
                // Documents
                'pdf': '📄', 'doc': '📝', 'docx': '📝', 'txt': '📝', 'rtf': '📝',
                // Audio
                'mp3': '🎵', 'wav': '🎵', 'ogg': '🎵', 'flac': '🎵', 'm4a': '🎵',
                // Archives
                'zip': '📦', 'rar': '📦', '7z': '📦',
                // Code
                'js': '💻', 'html': '💻', 'css': '💻', 'py': '💻', 'java': '💻'
            };
            
            return iconMap[extension] || '📎';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function downloadFile(fileName) {
            showNotification(`📥 Downloading ${fileName}...`);
        }

        // Audio playback functions
        function playAudio(button) {
            const audioMessage = button.closest('.audio-message');
            const progressBar = audioMessage.querySelector('.audio-progress');
            const isPlaying = button.textContent === '⏸️';
            
            if (isPlaying) {
                button.textContent = '▶️';
                // Stop audio simulation
                if (audioMessage.playInterval) {
                    clearInterval(audioMessage.playInterval);
                    audioMessage.playInterval = null;
                }
            } else {
                button.textContent = '⏸️';
                // Simulate audio playback
                let progress = 0;
                const duration = audioMessage.duration || 10;
                
                audioMessage.playInterval = setInterval(() => {
                    progress += 0.1;
                    const percentage = (progress / duration) * 100;
                    progressBar.style.width = Math.min(percentage, 100) + '%';
                    
                    if (progress >= duration) {
                        clearInterval(audioMessage.playInterval);
                        audioMessage.playInterval = null;
                        button.textContent = '▶️';
                        progressBar.style.width = '0%';
                    }
                }, 100);
            }
        }

        function seekAudio(waveform, event) {
            const rect = waveform.getBoundingClientRect();
            const percentage = ((event.clientX - rect.left) / rect.width) * 100;
            const progressBar = waveform.querySelector('.audio-progress');
            progressBar.style.width = Math.min(Math.max(percentage, 0), 100) + '%';
        }

        // Auto-resize textarea with smooth animation
        document.getElementById('messageInput').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
            updateSendButton();
        });

        // Enhanced enter key handling
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                if (this.value.trim()) {
                    sendMessage();
                }
            }
        });

        // Mouse events for recording
        document.getElementById('sendBtn').addEventListener('mousedown', function(e) {
            if (!document.getElementById('messageInput').value.trim()) {
                e.preventDefault();
                startRecording();
            }
        });

        document.getElementById('sendBtn').addEventListener('mouseup', function(e) {
            if (isRecording) {
                e.preventDefault();
                stopRecording();
            }
        });

        document.getElementById('sendBtn').addEventListener('mouseleave', function(e) {
            if (isRecording) {
                e.preventDefault();
                stopRecording();
            }
        });

        // Modal functions with enhanced animations
        function openProfileModal() {
            const modal = document.getElementById('profileModal');
            modal.classList.add('active');
            modal.style.opacity = '0';
            setTimeout(() => modal.style.opacity = '1', 50);
        }

        function openGroupModal() {
            const modal = document.getElementById('groupModal');
            modal.classList.add('active');
            modal.style.opacity = '0';
            setTimeout(() => modal.style.opacity = '1', 50);
        }

        function openChannelModal() {
            const modal = document.getElementById('channelModal');
            modal.classList.add('active');
            modal.style.opacity = '0';
            setTimeout(() => modal.style.opacity = '1', 50);
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.opacity = '0';
            setTimeout(() => modal.classList.remove('active'), 300);
        }

        // Enhanced video call functions
        function startVideoCall() {
            const videoCall = document.getElementById('videoCallContainer');
            videoCall.classList.add('active');
            callTimer = 0;
            callInterval = setInterval(() => {
                callTimer++;
                const minutes = Math.floor(callTimer / 60).toString().padStart(2, '0');
                const seconds = (callTimer % 60).toString().padStart(2, '0');
                document.getElementById('callTimer').textContent = `${minutes}:${seconds}`;
            }, 1000);
        }

        function endCall() {
            const videoCall = document.getElementById('videoCallContainer');
            videoCall.style.opacity = '0';
            setTimeout(() => {
                videoCall.classList.remove('active');
                videoCall.style.opacity = '1';
            }, 300);
            clearInterval(callInterval);
            callTimer = 0;
        }

        function toggleMute() {
            isMuted = !isMuted;
            const btn = document.getElementById('muteBtn');
            btn.textContent = isMuted ? '🔇' : '🎤';
            btn.style.background = isMuted ? 'rgba(255, 0, 0, 0.2)' : 'rgba(0, 255, 255, 0.1)';
            btn.style.borderColor = isMuted ? 'rgba(255, 0, 0, 0.5)' : 'rgba(0, 255, 255, 0.3)';
        }

        function toggleVideo() {
            isVideoOn = !isVideoOn;
            const btn = document.getElementById('videoBtn');
            btn.textContent = isVideoOn ? '📹' : '📷';
            btn.style.background = isVideoOn ? 'rgba(0, 255, 255, 0.1)' : 'rgba(255, 0, 0, 0.2)';
            btn.style.borderColor = isVideoOn ? 'rgba(0, 255, 255, 0.3)' : 'rgba(255, 0, 0, 0.5)';
        }

        function toggleAR() {
            isARMode = !isARMode;
            const btn = document.getElementById('arBtn');
            btn.textContent = isARMode ? '🥽' : '👓';
            btn.style.background = isARMode ? 'rgba(0, 255, 0, 0.2)' : 'rgba(0, 255, 255, 0.1)';
            btn.style.borderColor = isARMode ? 'rgba(0, 255, 0, 0.5)' : 'rgba(0, 255, 255, 0.3)';
        }

        function shareScreen() {
            showNotification('🚀 Screen sharing activated! AR/VR display is now being shared.');
        }

        // Enhanced notification system
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, rgba(0, 255, 255, 0.9), rgba(255, 0, 255, 0.9));
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                font-weight: 600;
                z-index: 10000;
                animation: slideIn 0.3s ease;
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.2);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        function startAudioCall() {
            showNotification('📞 Starting AR/VR audio call with spatial audio!');
        }

        // Enhanced creation functions
        function createGroup() {
            const name = document.getElementById('groupName').value;
            const description = document.getElementById('groupDescription').value;
            const space = document.getElementById('groupSpace').value;
            const privacy = document.getElementById('groupPrivacy').value;
            
            if (name) {
                showNotification(`✅ Group "${name}" created successfully!`);
                closeModal('groupModal');
                
                // Add to groups tab
                const groupsTab = document.getElementById('groupsTab');
                const newGroup = document.createElement('div');
                newGroup.className = 'chat-item';
                newGroup.onclick = () => selectChat(name, name.charAt(0));
                newGroup.innerHTML = `
                    <div class="chat-avatar">${name.charAt(0)}</div>
                    <div class="chat-info">
                        <h4>${name}</h4>
                        <p>Group created • ${space}</p>
                    </div>
                    <div class="chat-meta">
                        <div class="chat-time">now</div>
                    </div>
                `;
                groupsTab.appendChild(newGroup);
                
                // Clear form
                document.getElementById('groupName').value = '';
                document.getElementById('groupDescription').value = '';
            }
        }

        function createChannel() {
            const name = document.getElementById('channelName').value;
            const type = document.getElementById('channelType').value;
            const description = document.getElementById('channelDescription').value;
            const immersion = document.getElementById('immersionLevel').value;
            
            if (name) {
                showNotification(`📢 Channel "${name}" created successfully!`);
                closeModal('channelModal');
                
                // Add to channels tab
                const channelsTab = document.getElementById('channelsTab');
                const newChannel = document.createElement('div');
                newChannel.className = 'chat-item';
                newChannel.onclick = () => selectChat(name, '#');
                newChannel.innerHTML = `
                    <div class="chat-avatar">#</div>
                    <div class="chat-info">
                        <h4>${name}</h4>
                        <p>Channel • ${type}</p>
                    </div>
                    <div class="chat-meta">
                        <div class="chat-time">now</div>
                    </div>
                `;
                channelsTab.appendChild(newChannel);
                
                // Clear form
                document.getElementById('channelName').value = '';
                document.getElementById('channelDescription').value = '';
            }
        }

        function saveProfile() {
            const displayName = document.getElementById('displayName').value;
            const statusMessage = document.getElementById('statusMessage').value;
            const avatarTheme = document.getElementById('avatarTheme').value;
            const vrEnvironment = document.getElementById('vrEnvironment').value;
            
            // Update profile display
            document.querySelector('.profile-info h3').textContent = displayName;
            document.querySelector('.profile-info p').textContent = statusMessage;
            
            showNotification('✅ Profile updated successfully!');
            closeModal('profileModal');
        }

        // Add CSS animations for notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Close modals when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal(modal.id);
                }
            });
        });



        // Context menu and message selection functions
        function addMessageEventListeners(messageElement) {
            const messageContent = messageElement.querySelector('.message-content');
            
            // Right-click context menu
            messageContent.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                showContextMenu(e, messageElement);
            });
            
            // Long press for mobile
            let longPressTimer;
            let startX, startY;
            
            messageContent.addEventListener('touchstart', function(e) {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                longPressStarted = false;
                
                longPressTimer = setTimeout(() => {
                    longPressStarted = true;
                    showLongPressIndicator(e.touches[0]);
                    showContextMenu(e.touches[0], messageElement);
                }, 500);
            });
            
            messageContent.addEventListener('touchmove', function(e) {
                const moveX = Math.abs(e.touches[0].clientX - startX);
                const moveY = Math.abs(e.touches[0].clientY - startY);
                
                if (moveX > 10 || moveY > 10) {
                    clearTimeout(longPressTimer);
                }
            });
            
            messageContent.addEventListener('touchend', function(e) {
                clearTimeout(longPressTimer);
                if (longPressStarted) {
                    e.preventDefault();
                }
            });
            
            // Click for selection when in selection mode
            messageContent.addEventListener('click', function(e) {
                if (selectedMessages.size > 0) {
                    e.preventDefault();
                    toggleMessageSelection(messageElement);
                }
            });
        }

        function showContextMenu(event, messageElement) {
            const contextMenu = document.getElementById('contextMenu');
            currentContextMessage = messageElement;
            
            // Position the context menu
            const x = event.clientX || event.pageX;
            const y = event.clientY || event.pageY;
            
            contextMenu.style.left = x + 'px';
            contextMenu.style.top = y + 'px';
            contextMenu.classList.add('active');
            
            // Adjust position if menu goes off screen
            setTimeout(() => {
                const rect = contextMenu.getBoundingClientRect();
                if (rect.right > window.innerWidth) {
                    contextMenu.style.left = (x - rect.width) + 'px';
                }
                if (rect.bottom > window.innerHeight) {
                    contextMenu.style.top = (y - rect.height) + 'px';
                }
            }, 10);
        }

        function showLongPressIndicator(touch) {
            const indicator = document.getElementById('longPressIndicator');
            indicator.style.left = touch.clientX + 'px';
            indicator.style.top = touch.clientY + 'px';
            indicator.classList.add('active');
            
            setTimeout(() => {
                indicator.classList.remove('active');
            }, 800);
        }

        function hideContextMenu() {
            document.getElementById('contextMenu').classList.remove('active');
            currentContextMessage = null;
        }

        // Context menu actions
        function replyToMessage() {
            if (currentContextMessage) {
                const messageText = currentContextMessage.querySelector('.message-text').textContent;
                const input = document.getElementById('messageInput');
                input.value = `Replying to: "${messageText.substring(0, 50)}${messageText.length > 50 ? '...' : ''}"\n\n`;
                input.focus();
                showNotification('💬 Reply mode activated');
            }
            hideContextMenu();
        }

        function editMessage() {
            if (currentContextMessage && currentContextMessage.classList.contains('sent')) {
                const messageText = currentContextMessage.querySelector('.message-text');
                const originalText = messageText.textContent;
                
                messageText.innerHTML = `<input type="text" value="${originalText}" style="background: transparent; border: 1px solid rgba(0,255,255,0.5); color: white; padding: 4px; border-radius: 4px; width: 100%;" onblur="saveEdit(this)" onkeypress="if(event.key==='Enter') saveEdit(this)">`;
                messageText.querySelector('input').focus();
                showNotification('✏️ Edit mode activated');
            } else {
                showNotification('❌ You can only edit your own messages');
            }
            hideContextMenu();
        }

        function saveEdit(input) {
            const newText = input.value.trim();
            if (newText) {
                input.parentElement.textContent = newText;
                showNotification('✅ Message updated');
            }
        }

        function copyMessage() {
            if (currentContextMessage) {
                const messageText = currentContextMessage.querySelector('.message-text').textContent;
                navigator.clipboard.writeText(messageText).then(() => {
                    showNotification('📋 Message copied to clipboard');
                }).catch(() => {
                    showNotification('❌ Failed to copy message');
                });
            }
            hideContextMenu();
        }

        function forwardMessage() {
            if (currentContextMessage) {
                showNotification('➡️ Forward feature activated');
            }
            hideContextMenu();
        }

        function selectMessage() {
            if (currentContextMessage) {
                toggleMessageSelection(currentContextMessage);
            }
            hideContextMenu();
        }

        function pinMessage() {
            if (currentContextMessage) {
                showNotification('📌 Message pinned');
            }
            hideContextMenu();
        }

        function saveToFavorites() {
            if (currentContextMessage) {
                showNotification('⭐ Message saved to favorites');
            }
            hideContextMenu();
        }

        function deleteMessage() {
            if (currentContextMessage) {
                currentContextMessage.style.animation = 'messageSlide 0.3s reverse';
                setTimeout(() => {
                    currentContextMessage.remove();
                    showNotification('🗑️ Message deleted');
                }, 300);
            }
            hideContextMenu();
        }

        // Message selection functions
        function toggleMessageSelection(messageElement) {
            const messageId = messageElement.getAttribute('data-message-id');
            
            if (selectedMessages.has(messageId)) {
                selectedMessages.delete(messageId);
                messageElement.classList.remove('selected');
            } else {
                selectedMessages.add(messageId);
                messageElement.classList.add('selected');
            }
            
            updateSelectionToolbar();
        }

        function updateSelectionToolbar() {
            const toolbar = document.getElementById('selectionToolbar');
            const countElement = document.getElementById('selectionCount');
            
            if (selectedMessages.size > 0) {
                toolbar.classList.add('active');
                countElement.textContent = `${selectedMessages.size} selected`;
            } else {
                toolbar.classList.remove('active');
            }
        }

        function clearSelection() {
            selectedMessages.clear();
            document.querySelectorAll('.message.selected').forEach(msg => {
                msg.classList.remove('selected');
            });
            updateSelectionToolbar();
        }

        function replyToSelected() {
            if (selectedMessages.size === 1) {
                const messageId = Array.from(selectedMessages)[0];
                const messageElement = document.querySelector(`[data-message-id="${messageId}"]`);
                currentContextMessage = messageElement;
                replyToMessage();
            }
            clearSelection();
        }

        function forwardSelected() {
            showNotification(`➡️ Forwarding ${selectedMessages.size} message(s)`);
            clearSelection();
        }

        function copySelected() {
            const messages = Array.from(selectedMessages).map(id => {
                const element = document.querySelector(`[data-message-id="${id}"]`);
                return element.querySelector('.message-text').textContent;
            }).join('\n\n');
            
            navigator.clipboard.writeText(messages).then(() => {
                showNotification(`📋 ${selectedMessages.size} message(s) copied`);
            });
            clearSelection();
        }

        function deleteSelected() {
            const messagesToDelete = Array.from(selectedMessages);
            messagesToDelete.forEach(id => {
                const element = document.querySelector(`[data-message-id="${id}"]`);
                if (element) {
                    element.style.animation = 'messageSlide 0.3s reverse';
                    setTimeout(() => element.remove(), 300);
                }
            });
            
            showNotification(`🗑️ ${messagesToDelete.length} message(s) deleted`);
            clearSelection();
        }

        // Chat profile and options functions
        function openChatProfile() {
            const modal = document.getElementById('chatProfileModal');
            const currentName = document.getElementById('currentChatName').textContent;
            const currentAvatar = document.getElementById('currentChatAvatar').textContent;
            const currentStatus = document.getElementById('currentChatStatus').textContent;
            
            // Update profile modal with current chat data
            document.getElementById('chatProfileTitle').textContent = currentName;
            document.getElementById('chatProfileName').textContent = currentName;
            document.getElementById('chatProfileAvatar').textContent = currentAvatar;
            document.getElementById('chatProfileStatus').textContent = currentStatus;
            
            // Set different data based on chat type
            const profileData = getChatProfileData(currentName);
            document.getElementById('chatProfilePhone').textContent = profileData.phone;
            document.getElementById('chatProfileUsername').textContent = profileData.username;
            document.getElementById('chatProfileBio').textContent = profileData.bio;
            document.getElementById('chatProfileVREnv').textContent = profileData.vrEnv;
            document.getElementById('chatProfileTimezone').textContent = profileData.timezone;
            document.getElementById('chatProfileJoined').textContent = profileData.joined;
            document.getElementById('chatProfileScore').textContent = profileData.score;
            
            modal.classList.add('active');
            modal.style.opacity = '0';
            setTimeout(() => modal.style.opacity = '1', 50);
        }

        function getChatProfileData(chatName) {
            const profiles = {
                'Alex Chen': {
                    phone: '+1 (555) 123-4567',
                    username: '@alexchen_ar',
                    bio: 'AR/VR Developer passionate about creating immersive experiences. Currently working on next-gen holographic interfaces and spatial computing solutions.',
                    vrEnv: 'Cyber City',
                    timezone: 'PST (UTC-8)',
                    joined: 'March 2024',
                    score: '2,847 points'
                },
                'Sarah Wilson': {
                    phone: '+1 (555) 987-6543',
                    username: '@sarahw_vr',
                    bio: 'UX Designer specializing in VR interfaces. Love creating intuitive experiences in virtual worlds.',
                    vrEnv: 'Digital Forest',
                    timezone: 'EST (UTC-5)',
                    joined: 'January 2024',
                    score: '3,156 points'
                },
                'Mike Johnson': {
                    phone: '+1 (555) 456-7890',
                    username: '@mikej_holo',
                    bio: 'Holographic systems engineer. Building the future of mixed reality communication.',
                    vrEnv: 'Space Station',
                    timezone: 'CST (UTC-6)',
                    joined: 'February 2024',
                    score: '4,023 points'
                },
                'AR/VR Team': {
                    phone: 'Group Chat',
                    username: '@arvr_team',
                    bio: 'Official AR/VR development team. Collaborating on cutting-edge immersive technologies.',
                    vrEnv: 'Holographic Conference',
                    timezone: 'Multiple Zones',
                    joined: 'December 2023',
                    score: '5 members'
                },
                'Design Squad': {
                    phone: 'Group Chat',
                    username: '@design_squad',
                    bio: 'Creative minds designing the future of virtual experiences.',
                    vrEnv: 'Cyber Lounge',
                    timezone: 'Multiple Zones',
                    joined: 'November 2023',
                    score: '8 members'
                },
                'Dev Updates': {
                    phone: 'Channel',
                    username: '@dev_updates',
                    bio: 'Latest development updates and feature releases for AR/VR platform.',
                    vrEnv: 'AR Broadcast',
                    timezone: 'UTC',
                    joined: 'October 2023',
                    score: '156 subscribers'
                },
                'AR News': {
                    phone: 'Channel',
                    username: '@ar_news',
                    bio: 'Breaking news and trends in augmented reality technology.',
                    vrEnv: 'AR Broadcast',
                    timezone: 'UTC',
                    joined: 'September 2023',
                    score: '2.3K subscribers'
                }
            };
            
            return profiles[chatName] || profiles['Alex Chen'];
        }

        function openChatOptions() {
            const menu = document.getElementById('chatOptionsMenu');
            const btn = event.target.closest('.action-btn');
            const rect = btn.getBoundingClientRect();
            
            menu.style.left = (rect.left - 150) + 'px';
            menu.style.top = (rect.bottom + 10) + 'px';
            menu.classList.add('active');
            
            // Adjust position if menu goes off screen
            setTimeout(() => {
                const menuRect = menu.getBoundingClientRect();
                if (menuRect.right > window.innerWidth) {
                    menu.style.left = (rect.right - menuRect.width) + 'px';
                }
                if (menuRect.bottom > window.innerHeight) {
                    menu.style.top = (rect.top - menuRect.height - 10) + 'px';
                }
            }, 10);
        }

        function startChatFromProfile() {
            closeModal('chatProfileModal');
            document.getElementById('messageInput').focus();
            showNotification('💬 Ready to chat!');
        }

        // Chat options menu functions
        function viewSharedMedia() {
            showNotification('🖼️ Opening shared media gallery...');
            hideContextMenu();
        }

        function searchInChat() {
            showNotification('🔍 Search functionality activated');
            hideContextMenu();
        }

        function exportChat() {
            showNotification('📤 Exporting chat history...');
            hideContextMenu();
        }

        function muteNotifications() {
            showNotification('🔕 Notifications muted for this chat');
            hideContextMenu();
        }

        function changeWallpaper() {
            showNotification('🎨 Wallpaper customization opened');
            hideContextMenu();
        }

        function clearChatHistory() {
            showNotification('🧹 Chat history cleared');
            hideContextMenu();
        }

        function blockUser() {
            showNotification('🚫 User blocked');
            hideContextMenu();
        }

        function deleteChat() {
            showNotification('🗑️ Chat deleted');
            hideContextMenu();
        }

        // Close context menu when clicking elsewhere
        document.addEventListener('click', function(e) {
            const contextMenu = document.getElementById('contextMenu');
            const chatOptionsMenu = document.getElementById('chatOptionsMenu');
            const attachmentMenu = document.getElementById('attachmentMenu');
            const attachmentBtn = document.getElementById('attachmentBtn');
            
            if (!contextMenu.contains(e.target)) {
                hideContextMenu();
            }
            
            if (!chatOptionsMenu.contains(e.target) && !e.target.closest('.action-btn')) {
                chatOptionsMenu.classList.remove('active');
            }
            
            if (attachmentMenuOpen && !attachmentMenu.contains(e.target) && !attachmentBtn.contains(e.target)) {
                toggleAttachmentMenu();
            }
        });

        // Initialize with smooth fade-in
        document.addEventListener('DOMContentLoaded', function() {
            document.body.style.opacity = '0';
            setTimeout(() => {
                document.body.style.transition = 'opacity 0.5s ease';
                document.body.style.opacity = '1';
            }, 100);
            
            // Add event listeners to existing messages
            document.querySelectorAll('.message').forEach(addMessageEventListeners);
            
            console.log('🚀 AR/VR Messenger Premium initialized successfully!');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96a60e8fc7852e13',t:'MTc1NDM5NDQxNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>